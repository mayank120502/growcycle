<?php
 use Tygh\Registry; use Tygh\Enum\AffiliateUserTypes; defined('BOOTSTRAP') or die('Access denied'); if ($_SERVER['REQUEST_METHOD'] == 'POST') { if ($mode === 'update') { if ($_REQUEST['usergroup_data']['type'] !== AffiliateUserTypes::PARTNER) { unset($_REQUEST['usergroup_data']['privileges']['partnership']); } } } if ($mode === 'get_privileges') { $usergroup = [ 'type' => $_REQUEST['type'], ]; if ($usergroup['type'] == AffiliateUserTypes::PARTNER) { $show_privileges_tab = fn_check_can_usergroup_have_privileges($usergroup); $grouped_privileges = []; if ($show_privileges_tab) { $privileges_data = (array) fn_get_usergroup_privileges($usergroup); $grouped_privileges = fn_group_usergroup_privileges($privileges_data); } Tygh::$app['view']->assign('grouped_privileges', $grouped_privileges); Tygh::$app['view']->assign('id', 0); Tygh::$app['view']->assign('show_privileges_tab', $show_privileges_tab); Tygh::$app['view']->display('views/usergroups/components/get_privileges.tpl'); return [CONTROLLER_STATUS_NO_CONTENT]; } } 